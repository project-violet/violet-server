# Violet Statistics

## Query for View Time

```sql
# Basic
select count(*) from viewtime;
+----------+
| count(*) |
+----------+
|   209119 |
+----------+ 
select count(*) 
from viewtime as a left join article_pages as b on a.ArticleId=b.Id 
where b.Pages<>0;
+----------+
| count(*) |
+----------+
|   199059 |
+----------+
select count(*) 
from 
(
    select *
    from viewtime
    group by ViewSeconds order by ViewSeconds
) as a;
+----------+
| count(*) |
+----------+
|     3084 |
+----------+

# Average, Variance watching seconds per pages
select avg(a.ViewSeconds/b.Pages), variance(a.ViewSeconds/b.Pages)
from viewtime as a left join article_pages as b on a.ArticleId=b.Id 
where b.Pages<>0 and a.ViewSeconds/b.Pages;
+----------------------------+---------------------------------+
| avg(a.ViewSeconds/b.Pages) | variance(a.ViewSeconds/b.Pages) |
+----------------------------+---------------------------------+
|                 6.21027920 |                  26519.15946969 |
+----------------------------+---------------------------------+
std: 162.847043171
  p: x<=302.50143 = 0.9808
#
select avg(a.ViewSeconds/b.Pages), variance(a.ViewSeconds/b.Pages)
from viewtime as a left join article_pages as b on a.ArticleId=b.Id 
where b.Pages<>0 and a.ViewSeconds/b.Pages<=11;
+----------------------------+---------------------------------+
| avg(a.ViewSeconds/b.Pages) | variance(a.ViewSeconds/b.Pages) |
+----------------------------+---------------------------------+
|                 2.41849552 |                      5.64339886 |
+----------------------------+---------------------------------+

# Median watching seconds per pages
select ceil(count(*)/2)
from viewtime as a left join article_pages as b on a.ArticleId=b.Id 
where b.Pages<>0;
select a.ViewSeconds/b.Pages as c
from viewtime as a left join article_pages as b on a.ArticleId=b.Id 
where b.Pages<>0 order by c asc limit 99596,1;
+--------+
| c      |
+--------+
| 1.8000 |
+--------+

# ViewSeconds Counts
select ViewSeconds, count(*), repeat('#', count(*)/100), count(*)/199059*100 as percent, 
    sum(count(*)/209119*100) OVER(ORDER BY ViewSeconds) as acc
from viewtime
group by ViewSeconds order by ViewSeconds limit 1000;
+-------------+----------+------------------------------------------+---------+---------+
| ViewSeconds | count(*) | repeat('#', count(*)/100)                | percent | acc     |
+-------------+----------+------------------------------------------+---------+---------+
|           0 |       11 |                                          |  0.0055 |  0.0053 |
|           1 |      322 | ###                                      |  0.1618 |  0.1592 |
|           2 |     1170 | ############                             |  0.5878 |  0.7187 |
|           3 |     1472 | ###############                          |  0.7395 |  1.4226 |
|           4 |     1713 | #################                        |  0.8605 |  2.2418 |
|           5 |     2403 | ########################                 |  1.2072 |  3.3909 |
|           6 |     3240 | ################################         |  1.6277 |  4.9402 |
|           7 |     3732 | #####################################    |  1.8748 |  6.7249 |
|           8 |     3986 | ######################################## |  2.0024 |  8.6310 |
|           9 |     3922 | #######################################  |  1.9703 | 10.5065 |
|          10 |     3800 | ######################################   |  1.9090 | 12.3236 |
|          11 |     3786 | ######################################   |  1.9019 | 14.1341 |
|          12 |     3528 | ###################################      |  1.7723 | 15.8211 |
|          13 |     3383 | ##################################       |  1.6995 | 17.4389 |
|          14 |     3222 | ################################         |  1.6186 | 18.9796 |
|          15 |     2961 | ##############################           |  1.4875 | 20.3956 |
|          16 |     2827 | ############################             |  1.4202 | 21.7474 |
|          17 |     2671 | ###########################              |  1.3418 | 23.0247 |
|          18 |     2528 | #########################                |  1.2700 | 24.2336 |
|          19 |     2421 | ########################                 |  1.2162 | 25.3913 |
|          20 |     2309 | #######################                  |  1.1600 | 26.4954 |
|          21 |     2157 | ######################                   |  1.0836 | 27.5269 |
|          22 |     2171 | ######################                   |  1.0906 | 28.5651 |
|          23 |     2070 | #####################                    |  1.0399 | 29.5549 |
|          24 |     1946 | ###################                      |  0.9776 | 30.4855 |
|          25 |     1939 | ###################                      |  0.9741 | 31.4127 |
|          26 |     1786 | ##################                       |  0.8972 | 32.2668 |
|          27 |     1718 | #################                        |  0.8631 | 33.0883 |
|          28 |     1788 | ##################                       |  0.8982 | 33.9434 |
|          29 |     1658 | #################                        |  0.8329 | 34.7362 |
|          30 |     1627 | ################                         |  0.8173 | 35.5142 |
|          31 |     1480 | ###############                          |  0.7435 | 36.2220 |
|          32 |     1547 | ###############                          |  0.7772 | 36.9617 |
|          33 |     1458 | ###############                          |  0.7324 | 37.6589 |
|          34 |     1450 | ###############                          |  0.7284 | 38.3523 |
|          35 |     1399 | ##############                           |  0.7028 | 39.0213 |
|          36 |     1347 | #############                            |  0.6767 | 39.6655 |
|          37 |     1398 | ##############                           |  0.7023 | 40.3340 |
|          38 |     1372 | ##############                           |  0.6892 | 40.9901 |
|          39 |     1314 | #############                            |  0.6601 | 41.6184 |
|          40 |     1273 | #############                            |  0.6395 | 42.2272 |
|          41 |     1225 | ############                             |  0.6154 | 42.8129 |
|          42 |     1235 | ############                             |  0.6204 | 43.4035 |
|          43 |     1295 | #############                            |  0.6506 | 44.0228 |
|          44 |     1183 | ############                             |  0.5943 | 44.5885 |
|          45 |     1225 | ############                             |  0.6154 | 45.1743 |
|          46 |     1202 | ############                             |  0.6038 | 45.7491 |
|          47 |     1123 | ###########                              |  0.5642 | 46.2861 |
|          48 |     1167 | ############                             |  0.5863 | 46.8441 |
|          49 |     1143 | ###########                              |  0.5742 | 47.3907 |
|          50 |     1051 | ###########                              |  0.5280 | 47.8933 |
|          51 |     1134 | ###########                              |  0.5697 | 48.4356 |
|          52 |     1067 | ###########                              |  0.5360 | 48.9458 |
|          53 |     1033 | ##########                               |  0.5189 | 49.4398 |
|          54 |     1150 | ############                             |  0.5777 | 49.9897 |
|          55 |     1053 | ###########                              |  0.5290 | 50.4933 |
|          56 |     1034 | ##########                               |  0.5194 | 50.9877 |
|          57 |     1026 | ##########                               |  0.5154 | 51.4783 |
|          58 |     1059 | ###########                              |  0.5320 | 51.9848 |
|          59 |      973 | ##########                               |  0.4888 | 52.4500 |
|          60 |      915 | #########                                |  0.4597 | 52.8876 |
|          61 |      980 | ##########                               |  0.4923 | 53.3562 |
|          62 |      962 | ##########                               |  0.4833 | 53.8162 |
|          63 |      936 | #########                                |  0.4702 | 54.2638 |
|          64 |      965 | ##########                               |  0.4848 | 54.7253 |
|          65 |      912 | #########                                |  0.4582 | 55.1614 |
|          66 |      940 | #########                                |  0.4722 | 55.6109 |
|          67 |      908 | #########                                |  0.4561 | 56.0451 |
|          68 |      867 | #########                                |  0.4355 | 56.4597 |
|          69 |      928 | #########                                |  0.4662 | 56.9035 |
|          70 |      876 | #########                                |  0.4401 | 57.3224 |
|          71 |      925 | #########                                |  0.4647 | 57.7647 |
|          72 |      869 | #########                                |  0.4366 | 58.1803 |
|          73 |      839 | ########                                 |  0.4215 | 58.5815 |
|          74 |      866 | #########                                |  0.4350 | 58.9956 |
|          75 |      823 | ########                                 |  0.4134 | 59.3891 |
|          76 |      833 | ########                                 |  0.4185 | 59.7875 |
|          77 |      823 | ########                                 |  0.4134 | 60.1810 |
|          78 |      871 | #########                                |  0.4376 | 60.5976 |
|          79 |      835 | ########                                 |  0.4195 | 60.9968 |
|          80 |      789 | ########                                 |  0.3964 | 61.3741 |
|          81 |      759 | ########                                 |  0.3813 | 61.7371 |
|          82 |      800 | ########                                 |  0.4019 | 62.1197 |
|          83 |      749 | #######                                  |  0.3763 | 62.4778 |
|          84 |      781 | ########                                 |  0.3923 | 62.8513 |
|          85 |      736 | #######                                  |  0.3697 | 63.2032 |
|          86 |      759 | ########                                 |  0.3813 | 63.5662 |
|          87 |      707 | #######                                  |  0.3552 | 63.9043 |
|          88 |      723 | #######                                  |  0.3632 | 64.2500 |
|          89 |      780 | ########                                 |  0.3918 | 64.6230 |
|          90 |      727 | #######                                  |  0.3652 | 64.9707 |
|          91 |      708 | #######                                  |  0.3557 | 65.3092 |
|          92 |      687 | #######                                  |  0.3451 | 65.6377 |
|          93 |      702 | #######                                  |  0.3527 | 65.9734 |
|          94 |      669 | #######                                  |  0.3361 | 66.2934 |
|          95 |      667 | #######                                  |  0.3351 | 66.6123 |
|          96 |      650 | #######                                  |  0.3265 | 66.9231 |
|          97 |      641 | ######                                   |  0.3220 | 67.2297 |
|          98 |      695 | #######                                  |  0.3491 | 67.5620 |
|          99 |      666 | #######                                  |  0.3346 | 67.8805 |
|         100 |      632 | ######                                   |  0.3175 | 68.1827 |
|         101 |      618 | ######                                   |  0.3105 | 68.4782 |
|         102 |      665 | #######                                  |  0.3341 | 68.7962 |
|         103 |      612 | ######                                   |  0.3074 | 69.0889 |
|         104 |      649 | ######                                   |  0.3260 | 69.3992 |
|         105 |      599 | ######                                   |  0.3009 | 69.6857 |
|         106 |      668 | #######                                  |  0.3356 | 70.0051 |
|         107 |      615 | ######                                   |  0.3090 | 70.2992 |
|         108 |      577 | ######                                   |  0.2899 | 70.5751 |
|         109 |      553 | ######                                   |  0.2778 | 70.8396 |
|         110 |      533 | #####                                    |  0.2678 | 71.0944 |
|         111 |      584 | ######                                   |  0.2934 | 71.3737 |
|         112 |      568 | ######                                   |  0.2853 | 71.6453 |
|         113 |      569 | ######                                   |  0.2858 | 71.9174 |
|         114 |      574 | ######                                   |  0.2884 | 72.1919 |
|         115 |      537 | #####                                    |  0.2698 | 72.4487 |
|         116 |      529 | #####                                    |  0.2658 | 72.7017 |
|         117 |      518 | #####                                    |  0.2602 | 72.9494 |
|         118 |      507 | #####                                    |  0.2547 | 73.1918 |
|         119 |      518 | #####                                    |  0.2602 | 73.4395 |
|         120 |      502 | #####                                    |  0.2522 | 73.6796 |
|         121 |      530 | #####                                    |  0.2663 | 73.9330 |
|         122 |      501 | #####                                    |  0.2517 | 74.1726 |
|         123 |      496 | #####                                    |  0.2492 | 74.4098 |
|         124 |      487 | #####                                    |  0.2447 | 74.6427 |
|         125 |      482 | #####                                    |  0.2421 | 74.8732 |
|         126 |      485 | #####                                    |  0.2436 | 75.1051 |
|         127 |      469 | #####                                    |  0.2356 | 75.3294 |
|         128 |      454 | #####                                    |  0.2281 | 75.5465 |
|         129 |      477 | #####                                    |  0.2396 | 75.7746 |
|         130 |      499 | #####                                    |  0.2507 | 76.0132 |
|         131 |      471 | #####                                    |  0.2366 | 76.2384 |
|         132 |      433 | ####                                     |  0.2175 | 76.4455 |
|         133 |      445 | ####                                     |  0.2236 | 76.6583 |
|         134 |      437 | ####                                     |  0.2195 | 76.8672 |
|         135 |      424 | ####                                     |  0.2130 | 77.0700 |
|         136 |      439 | ####                                     |  0.2205 | 77.2799 |
|         137 |      432 | ####                                     |  0.2170 | 77.4865 |
|         138 |      451 | #####                                    |  0.2266 | 77.7022 |
|         139 |      404 | ####                                     |  0.2030 | 77.8954 |
|         140 |      391 | ####                                     |  0.1964 | 78.0823 |
|         141 |      401 | ####                                     |  0.2014 | 78.2741 |
|         142 |      426 | ####                                     |  0.2140 | 78.4778 |
|         143 |      418 | ####                                     |  0.2100 | 78.6777 |
|         144 |      384 | ####                                     |  0.1929 | 78.8613 |
|         145 |      372 | ####                                     |  0.1869 | 79.0392 |
|         146 |      362 | ####                                     |  0.1819 | 79.2123 |
|         147 |      355 | ####                                     |  0.1783 | 79.3821 |
|         148 |      365 | ####                                     |  0.1834 | 79.5566 |
|         149 |      390 | ####                                     |  0.1959 | 79.7431 |
|         150 |      341 | ###                                      |  0.1713 | 79.9062 |
|         151 |      332 | ###                                      |  0.1668 | 80.0649 |
|         152 |      357 | ####                                     |  0.1793 | 80.2356 |
|         153 |      374 | ####                                     |  0.1879 | 80.4145 |
|         154 |      338 | ###                                      |  0.1698 | 80.5761 |
|         155 |      383 | ####                                     |  0.1924 | 80.7593 |
|         156 |      346 | ###                                      |  0.1738 | 80.9247 |
|         157 |      338 | ###                                      |  0.1698 | 81.0864 |
|         158 |      340 | ###                                      |  0.1708 | 81.2489 |
|         159 |      302 | ###                                      |  0.1517 | 81.3934 |
|         160 |      323 | ###                                      |  0.1623 | 81.5478 |
|         161 |      344 | ###                                      |  0.1728 | 81.7123 |
|         162 |      331 | ###                                      |  0.1663 | 81.8706 |
|         163 |      305 | ###                                      |  0.1532 | 82.0165 |
|         164 |      325 | ###                                      |  0.1633 | 82.1719 |
|         165 |      284 | ###                                      |  0.1427 | 82.3077 |
|         166 |      299 | ###                                      |  0.1502 | 82.4507 |
|         167 |      291 | ###                                      |  0.1462 | 82.5898 |
|         168 |      289 | ###                                      |  0.1452 | 82.7280 |
|         169 |      287 | ###                                      |  0.1442 | 82.8653 |
|         170 |      300 | ###                                      |  0.1507 | 83.0087 |
|         171 |      293 | ###                                      |  0.1472 | 83.1488 |
|         172 |      281 | ###                                      |  0.1412 | 83.2832 |
|         173 |      307 | ###                                      |  0.1542 | 83.4300 |
|         174 |      274 | ###                                      |  0.1376 | 83.5610 |
|         175 |      300 | ###                                      |  0.1507 | 83.7045 |
|         176 |      290 | ###                                      |  0.1457 | 83.8432 |
|         177 |      257 | ###                                      |  0.1291 | 83.9661 |
|         178 |      254 | ###                                      |  0.1276 | 84.0875 |
|         179 |      268 | ###                                      |  0.1346 | 84.2157 |
|         180 |      224 | ##                                       |  0.1125 | 84.3228 |
|         181 |      246 | ##                                       |  0.1236 | 84.4404 |
|         182 |      251 | ###                                      |  0.1261 | 84.5605 |
|         183 |      244 | ##                                       |  0.1226 | 84.6771 |
|         184 |      226 | ##                                       |  0.1135 | 84.7852 |
|         185 |      219 | ##                                       |  0.1100 | 84.8899 |
|         186 |      247 | ##                                       |  0.1241 | 85.0080 |
|         187 |      262 | ###                                      |  0.1316 | 85.1333 |
|         188 |      243 | ##                                       |  0.1221 | 85.2495 |
|         189 |      245 | ##                                       |  0.1231 | 85.3667 |
|         190 |      219 | ##                                       |  0.1100 | 85.4714 |
|         191 |      202 | ##                                       |  0.1015 | 85.5680 |
|         192 |      213 | ##                                       |  0.1070 | 85.6699 |
|         193 |      211 | ##                                       |  0.1060 | 85.7708 |
|         194 |      229 | ##                                       |  0.1150 | 85.8803 |
|         195 |      241 | ##                                       |  0.1211 | 85.9955 |
|         196 |      213 | ##                                       |  0.1070 | 86.0974 |
|         197 |      224 | ##                                       |  0.1125 | 86.2045 |
|         198 |      195 | ##                                       |  0.0980 | 86.2977 |
|         199 |      223 | ##                                       |  0.1120 | 86.4044 |
|         200 |      221 | ##                                       |  0.1110 | 86.5101 |
|         201 |      185 | ##                                       |  0.0929 | 86.5985 |
|         202 |      220 | ##                                       |  0.1105 | 86.7037 |
|         203 |      198 | ##                                       |  0.0995 | 86.7984 |
|         204 |      180 | ##                                       |  0.0904 | 86.8845 |
|         205 |      188 | ##                                       |  0.0944 | 86.9744 |
|         206 |      189 | ##                                       |  0.0949 | 87.0648 |
|         207 |      170 | ##                                       |  0.0854 | 87.1461 |
|         208 |      200 | ##                                       |  0.1005 | 87.2417 |
|         209 |      177 | ##                                       |  0.0889 | 87.3263 |
|         210 |      178 | ##                                       |  0.0894 | 87.4115 |
|         211 |      193 | ##                                       |  0.0970 | 87.5038 |
|         212 |      166 | ##                                       |  0.0834 | 87.5831 |
|         213 |      171 | ##                                       |  0.0859 | 87.6649 |
|         214 |      194 | ##                                       |  0.0975 | 87.7577 |
|         215 |      172 | ##                                       |  0.0864 | 87.8399 |
|         216 |      185 | ##                                       |  0.0929 | 87.9284 |
|         217 |      159 | ##                                       |  0.0799 | 88.0044 |
|         218 |      151 | ##                                       |  0.0759 | 88.0766 |
|         219 |      193 | ##                                       |  0.0970 | 88.1689 |
|         220 |      160 | ##                                       |  0.0804 | 88.2454 |
|         221 |      154 | ##                                       |  0.0774 | 88.3191 |
|         222 |      146 | #                                        |  0.0733 | 88.3889 |
|         223 |      173 | ##                                       |  0.0869 | 88.4716 |
|         224 |      154 | ##                                       |  0.0774 | 88.5453 |
|         225 |      141 | #                                        |  0.0708 | 88.6127 |
|         226 |      158 | ##                                       |  0.0794 | 88.6882 |
|         227 |      150 | ##                                       |  0.0754 | 88.7600 |
|         228 |      160 | ##                                       |  0.0804 | 88.8365 |
|         229 |      165 | ##                                       |  0.0829 | 88.9154 |
|         230 |      158 | ##                                       |  0.0794 | 88.9909 |
|         231 |      141 | #                                        |  0.0708 | 89.0584 |
|         232 |      168 | ##                                       |  0.0844 | 89.1387 |
|         233 |      128 | #                                        |  0.0643 | 89.1999 |
|         234 |      144 | #                                        |  0.0723 | 89.2688 |
|         235 |      134 | #                                        |  0.0673 | 89.3329 |
|         236 |      130 | #                                        |  0.0653 | 89.3950 |
|         237 |      154 | ##                                       |  0.0774 | 89.4687 |
|         238 |      148 | #                                        |  0.0743 | 89.5394 |
|         239 |      139 | #                                        |  0.0698 | 89.6059 |
|         240 |      117 | #                                        |  0.0588 | 89.6619 |
|         241 |      115 | #                                        |  0.0578 | 89.7168 |
|         242 |      109 | #                                        |  0.0548 | 89.7690 |
|         243 |      121 | #                                        |  0.0608 | 89.8268 |
|         244 |      119 | #                                        |  0.0598 | 89.8837 |
|         245 |      109 | #                                        |  0.0548 | 89.9359 |
|         246 |      124 | #                                        |  0.0623 | 89.9952 |
|         247 |      125 | #                                        |  0.0628 | 90.0549 |
|         248 |      128 | #                                        |  0.0643 | 90.1161 |
|         249 |      116 | #                                        |  0.0583 | 90.1716 |
|         250 |      123 | #                                        |  0.0618 | 90.2304 |
|         251 |      123 | #                                        |  0.0618 | 90.2892 |
|         252 |      124 | #                                        |  0.0623 | 90.3485 |
|         253 |      109 | #                                        |  0.0548 | 90.4007 |
|         254 |       96 | #                                        |  0.0482 | 90.4466 |
|         255 |      132 | #                                        |  0.0663 | 90.5097 |
|         256 |      121 | #                                        |  0.0608 | 90.5676 |
|         257 |      112 | #                                        |  0.0563 | 90.6211 |
|         258 |      126 | #                                        |  0.0633 | 90.6814 |
|         259 |      100 | #                                        |  0.0502 | 90.7292 |
|         260 |      113 | #                                        |  0.0568 | 90.7832 |
|         261 |      111 | #                                        |  0.0558 | 90.8363 |
|         262 |      114 | #                                        |  0.0573 | 90.8908 |
|         263 |      110 | #                                        |  0.0553 | 90.9434 |
|         264 |       88 | #                                        |  0.0442 | 90.9855 |
|         265 |      114 | #                                        |  0.0573 | 91.0400 |
|         266 |      105 | #                                        |  0.0527 | 91.0902 |
|         267 |      102 | #                                        |  0.0512 | 91.1390 |
|         268 |      103 | #                                        |  0.0517 | 91.1883 |
|         269 |      111 | #                                        |  0.0558 | 91.2413 |
|         270 |      106 | #                                        |  0.0533 | 91.2920 |
|         271 |      104 | #                                        |  0.0522 | 91.3418 |
|         272 |       99 | #                                        |  0.0497 | 91.3891 |
|         273 |       97 | #                                        |  0.0487 | 91.4355 |
|         274 |       89 | #                                        |  0.0447 | 91.4780 |
|         275 |      106 | #                                        |  0.0533 | 91.5287 |
|         276 |       92 | #                                        |  0.0462 | 91.5727 |
|         277 |      104 | #                                        |  0.0522 | 91.6225 |
|         278 |       90 | #                                        |  0.0452 | 91.6655 |
|         279 |       84 | #                                        |  0.0422 | 91.7057 |
|         280 |       89 | #                                        |  0.0447 | 91.7482 |
|         281 |      106 | #                                        |  0.0533 | 91.7989 |
|         282 |       67 | #                                        |  0.0337 | 91.8310 |
|         283 |       79 | #                                        |  0.0397 | 91.8687 |
|         284 |       85 | #                                        |  0.0427 | 91.9094 |
|         285 |      100 | #                                        |  0.0502 | 91.9572 |
|         286 |       81 | #                                        |  0.0407 | 91.9959 |
|         287 |       96 | #                                        |  0.0482 | 92.0418 |
|         288 |       62 | #                                        |  0.0311 | 92.0715 |
|         289 |       82 | #                                        |  0.0412 | 92.1107 |
|         290 |       78 | #                                        |  0.0392 | 92.1480 |
|         291 |       77 | #                                        |  0.0387 | 92.1848 |
|         292 |       83 | #                                        |  0.0417 | 92.2245 |
|         293 |       70 | #                                        |  0.0352 | 92.2580 |
|         294 |       79 | #                                        |  0.0397 | 92.2958 |
|         295 |       89 | #                                        |  0.0447 | 92.3383 |
|         296 |       86 | #                                        |  0.0432 | 92.3794 |
|         297 |       71 | #                                        |  0.0357 | 92.4134 |
|         298 |       87 | #                                        |  0.0437 | 92.4550 |
|         299 |       84 | #                                        |  0.0422 | 92.4952 |
|         300 |       84 | #                                        |  0.0422 | 92.5353 |
|         301 |       70 | #                                        |  0.0352 | 92.5688 |
|         302 |       86 | #                                        |  0.0432 | 92.6099 |
|         303 |       80 | #                                        |  0.0402 | 92.6482 |
|         304 |       65 | #                                        |  0.0327 | 92.6793 |
|         305 |       82 | #                                        |  0.0412 | 92.7185 |
|         306 |       71 | #                                        |  0.0357 | 92.7524 |
|         307 |       77 | #                                        |  0.0387 | 92.7893 |
|         308 |       64 | #                                        |  0.0322 | 92.8199 |
|         309 |       82 | #                                        |  0.0412 | 92.8591 |
|         310 |       81 | #                                        |  0.0407 | 92.8978 |
|         311 |       64 | #                                        |  0.0322 | 92.9284 |
|         312 |       70 | #                                        |  0.0352 | 92.9619 |
|         313 |       69 | #                                        |  0.0347 | 92.9949 |
|         314 |       63 | #                                        |  0.0316 | 93.0250 |
|         315 |       67 | #                                        |  0.0337 | 93.0570 |
|         316 |       72 | #                                        |  0.0362 | 93.0915 |
|         317 |       75 | #                                        |  0.0377 | 93.1273 |
|         318 |       70 | #                                        |  0.0352 | 93.1608 |
|         319 |       66 | #                                        |  0.0332 | 93.1924 |
|         320 |       57 | #                                        |  0.0286 | 93.2196 |
|         321 |       71 | #                                        |  0.0357 | 93.2536 |
|         322 |       59 | #                                        |  0.0296 | 93.2818 |
|         323 |       71 | #                                        |  0.0357 | 93.3158 |
|         324 |       56 | #                                        |  0.0281 | 93.3425 |
|         325 |       72 | #                                        |  0.0362 | 93.3770 |
|         326 |       57 | #                                        |  0.0286 | 93.4042 |
|         327 |       63 | #                                        |  0.0316 | 93.4343 |
|         328 |       51 | #                                        |  0.0256 | 93.4587 |
|         329 |       51 | #                                        |  0.0256 | 93.4831 |
|         330 |       58 | #                                        |  0.0291 | 93.5109 |
|         331 |       45 |                                          |  0.0226 | 93.5324 |
|         332 |       48 |                                          |  0.0241 | 93.5553 |
|         333 |       61 | #                                        |  0.0306 | 93.5845 |
|         334 |       54 | #                                        |  0.0271 | 93.6103 |
|         335 |       50 | #                                        |  0.0251 | 93.6342 |
|         336 |       49 |                                          |  0.0246 | 93.6577 |
|         337 |       52 | #                                        |  0.0261 | 93.6825 |
|         338 |       59 | #                                        |  0.0296 | 93.7107 |
|         339 |       53 | #                                        |  0.0266 | 93.7361 |
|         340 |       40 |                                          |  0.0201 | 93.7552 |
|         341 |       40 |                                          |  0.0201 | 93.7743 |
|         342 |       55 | #                                        |  0.0276 | 93.8006 |
|         343 |       60 | #                                        |  0.0301 | 93.8293 |
|         344 |       47 |                                          |  0.0236 | 93.8518 |
|         345 |       45 |                                          |  0.0226 | 93.8733 |
|         346 |       42 |                                          |  0.0211 | 93.8934 |
|         347 |       58 | #                                        |  0.0291 | 93.9211 |
|         348 |       65 | #                                        |  0.0327 | 93.9522 |
|         349 |       51 | #                                        |  0.0256 | 93.9766 |
|         350 |       55 | #                                        |  0.0276 | 94.0029 |
|         351 |       48 |                                          |  0.0241 | 94.0259 |
|         352 |       53 | #                                        |  0.0266 | 94.0512 |
|         353 |       47 |                                          |  0.0236 | 94.0737 |
|         354 |       37 |                                          |  0.0186 | 94.0914 |
|         355 |       53 | #                                        |  0.0266 | 94.1167 |
|         356 |       44 |                                          |  0.0221 | 94.1378 |
|         357 |       58 | #                                        |  0.0291 | 94.1655 |
|         358 |       57 | #                                        |  0.0286 | 94.1928 |
|         359 |       45 |                                          |  0.0226 | 94.2143 |
|         360 |       38 |                                          |  0.0191 | 94.2325 |
|         361 |       47 |                                          |  0.0236 | 94.2549 |
|         362 |       46 |                                          |  0.0231 | 94.2769 |
|         363 |       44 |                                          |  0.0221 | 94.2980 |
|         364 |       45 |                                          |  0.0226 | 94.3195 |
|         365 |       34 |                                          |  0.0171 | 94.3357 |
|         366 |       41 |                                          |  0.0206 | 94.3553 |
|         367 |       45 |                                          |  0.0226 | 94.3769 |
|         368 |       41 |                                          |  0.0206 | 94.3965 |
|         369 |       37 |                                          |  0.0186 | 94.4142 |
|         370 |       48 |                                          |  0.0241 | 94.4371 |
|         371 |       46 |                                          |  0.0231 | 94.4591 |
|         372 |       56 | #                                        |  0.0281 | 94.4859 |
|         373 |       31 |                                          |  0.0156 | 94.5007 |
|         374 |       26 |                                          |  0.0131 | 94.5132 |
|         375 |       53 | #                                        |  0.0266 | 94.5385 |
|         376 |       42 |                                          |  0.0211 | 94.5586 |
|         377 |       44 |                                          |  0.0221 | 94.5796 |
|         378 |       42 |                                          |  0.0211 | 94.5997 |
|         379 |       30 |                                          |  0.0151 | 94.6141 |
|         380 |       42 |                                          |  0.0211 | 94.6341 |
|         381 |       38 |                                          |  0.0191 | 94.6523 |
|         382 |       42 |                                          |  0.0211 | 94.6724 |
|         383 |       35 |                                          |  0.0176 | 94.6891 |
|         384 |       35 |                                          |  0.0176 | 94.7059 |
|         385 |       41 |                                          |  0.0206 | 94.7255 |
|         386 |       43 |                                          |  0.0216 | 94.7460 |
|         387 |       33 |                                          |  0.0166 | 94.7618 |
|         388 |       46 |                                          |  0.0231 | 94.7838 |
|         389 |       30 |                                          |  0.0151 | 94.7982 |
|         390 |       42 |                                          |  0.0211 | 94.8182 |
|         391 |       44 |                                          |  0.0221 | 94.8393 |
|         392 |       42 |                                          |  0.0211 | 94.8594 |
|         393 |       38 |                                          |  0.0191 | 94.8775 |
|         394 |       40 |                                          |  0.0201 | 94.8967 |
|         395 |       25 |                                          |  0.0126 | 94.9086 |
|         396 |       52 | #                                        |  0.0261 | 94.9335 |
|         397 |       39 |                                          |  0.0196 | 94.9521 |
|         398 |       47 |                                          |  0.0236 | 94.9746 |
|         399 |       42 |                                          |  0.0211 | 94.9947 |
|         400 |       28 |                                          |  0.0141 | 95.0081 |
|         401 |       39 |                                          |  0.0196 | 95.0267 |
|         402 |       33 |                                          |  0.0166 | 95.0425 |
|         403 |       49 |                                          |  0.0246 | 95.0659 |
|         404 |       26 |                                          |  0.0131 | 95.0784 |
|         405 |       38 |                                          |  0.0191 | 95.0966 |
|         406 |       34 |                                          |  0.0171 | 95.1128 |
|         407 |       36 |                                          |  0.0181 | 95.1300 |
|         408 |       32 |                                          |  0.0161 | 95.1453 |
|         409 |       25 |                                          |  0.0126 | 95.1573 |
|         410 |       33 |                                          |  0.0166 | 95.1731 |
|         411 |       26 |                                          |  0.0131 | 95.1855 |
|         412 |       27 |                                          |  0.0136 | 95.1984 |
|         413 |       32 |                                          |  0.0161 | 95.2137 |
|         414 |       38 |                                          |  0.0191 | 95.2319 |
|         415 |       31 |                                          |  0.0156 | 95.2467 |
|         416 |       36 |                                          |  0.0181 | 95.2639 |
|         417 |       35 |                                          |  0.0176 | 95.2807 |
|         418 |       29 |                                          |  0.0146 | 95.2945 |
|         419 |       40 |                                          |  0.0201 | 95.3137 |
|         420 |       31 |                                          |  0.0156 | 95.3285 |
|         421 |       34 |                                          |  0.0171 | 95.3447 |
|         422 |       28 |                                          |  0.0141 | 95.3581 |
|         423 |       28 |                                          |  0.0141 | 95.3715 |
|         424 |       39 |                                          |  0.0196 | 95.3902 |
|         425 |       26 |                                          |  0.0131 | 95.4026 |
|         426 |       21 |                                          |  0.0105 | 95.4126 |
|         427 |       33 |                                          |  0.0166 | 95.4284 |
|         428 |       25 |                                          |  0.0126 | 95.4404 |
|         429 |       26 |                                          |  0.0131 | 95.4528 |
|         430 |       18 |                                          |  0.0090 | 95.4614 |
|         431 |       31 |                                          |  0.0156 | 95.4762 |
|         432 |       26 |                                          |  0.0131 | 95.4887 |
|         433 |       24 |                                          |  0.0121 | 95.5001 |
|         434 |       26 |                                          |  0.0131 | 95.5126 |
|         435 |       31 |                                          |  0.0156 | 95.5274 |
|         436 |       28 |                                          |  0.0141 | 95.5408 |
|         437 |       25 |                                          |  0.0126 | 95.5528 |
|         438 |       28 |                                          |  0.0141 | 95.5661 |
|         439 |       31 |                                          |  0.0156 | 95.5810 |
|         440 |       27 |                                          |  0.0136 | 95.5939 |
|         441 |       25 |                                          |  0.0126 | 95.6058 |
|         442 |       30 |                                          |  0.0151 | 95.6202 |
|         443 |       32 |                                          |  0.0161 | 95.6355 |
|         444 |       33 |                                          |  0.0166 | 95.6513 |
|         445 |       30 |                                          |  0.0151 | 95.6656 |
|         446 |       33 |                                          |  0.0166 | 95.6814 |
|         447 |       28 |                                          |  0.0141 | 95.6948 |
|         448 |       35 |                                          |  0.0176 | 95.7115 |
|         449 |       24 |                                          |  0.0121 | 95.7230 |
|         450 |       37 |                                          |  0.0186 | 95.7407 |
|         451 |       26 |                                          |  0.0131 | 95.7531 |
|         452 |       27 |                                          |  0.0136 | 95.7660 |
|         453 |       29 |                                          |  0.0146 | 95.7799 |
|         454 |       21 |                                          |  0.0105 | 95.7899 |
|         455 |       30 |                                          |  0.0151 | 95.8043 |
|         456 |       26 |                                          |  0.0131 | 95.8167 |
|         457 |       23 |                                          |  0.0116 | 95.8277 |
|         458 |       19 |                                          |  0.0095 | 95.8368 |
|         459 |       18 |                                          |  0.0090 | 95.8454 |
|         460 |       33 |                                          |  0.0166 | 95.8612 |
|         461 |       27 |                                          |  0.0136 | 95.8741 |
|         462 |       23 |                                          |  0.0116 | 95.8851 |
|         463 |       23 |                                          |  0.0116 | 95.8961 |
|         464 |       21 |                                          |  0.0105 | 95.9061 |
|         465 |       24 |                                          |  0.0121 | 95.9176 |
|         466 |       27 |                                          |  0.0136 | 95.9305 |
|         467 |       26 |                                          |  0.0131 | 95.9430 |
|         468 |       30 |                                          |  0.0151 | 95.9573 |
|         469 |       19 |                                          |  0.0095 | 95.9664 |
|         470 |       26 |                                          |  0.0131 | 95.9788 |
|         471 |       24 |                                          |  0.0121 | 95.9903 |
|         472 |       21 |                                          |  0.0105 | 96.0003 |
|         473 |       22 |                                          |  0.0111 | 96.0109 |
|         474 |       32 |                                          |  0.0161 | 96.0262 |
|         475 |       26 |                                          |  0.0131 | 96.0386 |
|         476 |       28 |                                          |  0.0141 | 96.0520 |
|         477 |       18 |                                          |  0.0090 | 96.0606 |
|         478 |       18 |                                          |  0.0090 | 96.0692 |
|         479 |       16 |                                          |  0.0080 | 96.0769 |
|         480 |       17 |                                          |  0.0085 | 96.0850 |
|         481 |       22 |                                          |  0.0111 | 96.0955 |
|         482 |       36 |                                          |  0.0181 | 96.1127 |
|         483 |       21 |                                          |  0.0105 | 96.1228 |
|         484 |       21 |                                          |  0.0105 | 96.1328 |
|         485 |       23 |                                          |  0.0116 | 96.1438 |
|         486 |       28 |                                          |  0.0141 | 96.1572 |
|         487 |       28 |                                          |  0.0141 | 96.1706 |
|         488 |       21 |                                          |  0.0105 | 96.1806 |
|         489 |       19 |                                          |  0.0095 | 96.1897 |
|         490 |       24 |                                          |  0.0121 | 96.2012 |
|         491 |       28 |                                          |  0.0141 | 96.2146 |
|         492 |       22 |                                          |  0.0111 | 96.2251 |
|         493 |       25 |                                          |  0.0126 | 96.2370 |
|         494 |       25 |                                          |  0.0126 | 96.2490 |
|         495 |       15 |                                          |  0.0075 | 96.2562 |
|         496 |       23 |                                          |  0.0116 | 96.2672 |
|         497 |       21 |                                          |  0.0105 | 96.2772 |
|         498 |       30 |                                          |  0.0151 | 96.2916 |
|         499 |       19 |                                          |  0.0095 | 96.3006 |
|         500 |       27 |                                          |  0.0136 | 96.3136 |
|         501 |       26 |                                          |  0.0131 | 96.3260 |
|         502 |       23 |                                          |  0.0116 | 96.3370 |
|         503 |       29 |                                          |  0.0146 | 96.3509 |
|         504 |       17 |                                          |  0.0085 | 96.3590 |
|         505 |       16 |                                          |  0.0080 | 96.3666 |
|         506 |       22 |                                          |  0.0111 | 96.3772 |
|         507 |       23 |                                          |  0.0116 | 96.3882 |
|         508 |       23 |                                          |  0.0116 | 96.3992 |
|         509 |       20 |                                          |  0.0100 | 96.4087 |
|         510 |       21 |                                          |  0.0105 | 96.4188 |
...

# Seconds per Pages Counts
select truncate(round(a.ViewSeconds/b.Pages*5.0)/5.0,1) as c, count(*), repeat('#', count(*)/500), 
count(*)/209119*100 as percent, SUM(count(*)/199059*100) OVER(ORDER BY c) as acc 
from viewtime as a left join article_pages as b on a.ArticleId=b.Id 
where b.Pages <> 0
group by c order by c limit 100;
+------+----------+--------------------------------------+---------+---------+
| c    | count(*) | repeat('#', count(*)/500)            | percent | acc     |
+------+----------+--------------------------------------+---------+---------+
|  0.0 |    16735 | #################################    |  8.0026 |  8.4071 |
|  0.2 |    18075 | #################################### |  8.6434 | 17.4873 |
|  0.4 |    13105 | ##########################           |  6.2668 | 24.0708 |
|  0.6 |    11277 | #######################              |  5.3926 | 29.7359 |
|  0.8 |     8970 | ##################                   |  4.2894 | 34.2421 |
|  1.0 |     7939 | ################                     |  3.7964 | 38.2304 |
|  1.2 |     7210 | ##############                       |  3.4478 | 41.8524 |
|  1.4 |     6394 | #############                        |  3.0576 | 45.0645 |
|  1.6 |     6687 | #############                        |  3.1977 | 48.4238 |
|  1.8 |     5979 | ############                         |  2.8591 | 51.4275 |
|  2.0 |     5525 | ###########                          |  2.6420 | 54.2030 |
|  2.2 |     5375 | ###########                          |  2.5703 | 56.9032 |
|  2.4 |     4770 | ##########                           |  2.2810 | 59.2995 |
|  2.6 |     5041 | ##########                           |  2.4106 | 61.8319 |
|  2.8 |     4609 | #########                            |  2.2040 | 64.1473 |
|  3.0 |     4473 | #########                            |  2.1390 | 66.3944 |
|  3.2 |     4196 | ########                             |  2.0065 | 68.5023 |
|  3.4 |     3581 | #######                              |  1.7124 | 70.3013 |
|  3.6 |     3846 | ########                             |  1.8391 | 72.2334 |
|  3.8 |     3557 | #######                              |  1.7009 | 74.0203 |
|  4.0 |     3278 | #######                              |  1.5675 | 75.6670 |
|  4.2 |     3158 | ######                               |  1.5101 | 77.2535 |
|  4.4 |     2651 | #####                                |  1.2677 | 78.5852 |
|  4.6 |     2889 | ######                               |  1.3815 | 80.0366 |
|  4.8 |     2492 | #####                                |  1.1917 | 81.2885 |
|  5.0 |     2367 | #####                                |  1.1319 | 82.4776 |
|  5.2 |     2239 | ####                                 |  1.0707 | 83.6023 |
|  5.4 |     1905 | ####                                 |  0.9110 | 84.5594 |
|  5.6 |     2068 | ####                                 |  0.9889 | 85.5982 |
|  5.8 |     1751 | ####                                 |  0.8373 | 86.4779 |
|  6.0 |     1629 | ###                                  |  0.7790 | 87.2962 |
|  6.2 |     1507 | ###                                  |  0.7206 | 88.0533 |
|  6.4 |     1284 | ###                                  |  0.6140 | 88.6983 |
|  6.6 |     1335 | ###                                  |  0.6384 | 89.3690 |
|  6.8 |     1109 | ##                                   |  0.5303 | 89.9261 |
|  7.0 |     1133 | ##                                   |  0.5418 | 90.4953 |
|  7.2 |     1005 | ##                                   |  0.4806 | 91.0002 |
|  7.4 |      884 | ##                                   |  0.4227 | 91.4442 |
|  7.6 |      971 | ##                                   |  0.4643 | 91.9320 |
|  7.8 |      832 | ##                                   |  0.3979 | 92.3500 |
|  8.0 |      777 | ##                                   |  0.3716 | 92.7403 |
|  8.2 |      704 | #                                    |  0.3367 | 93.0940 |
|  8.4 |      603 | #                                    |  0.2884 | 93.3969 |
|  8.6 |      663 | #                                    |  0.3170 | 93.7300 |
|  8.8 |      607 | #                                    |  0.2903 | 94.0349 |
|  9.0 |      511 | #                                    |  0.2444 | 94.2916 |
|  9.2 |      527 | #                                    |  0.2520 | 94.5564 |
|  9.4 |      414 | #                                    |  0.1980 | 94.7644 |
|  9.6 |      426 | #                                    |  0.2037 | 94.9784 |
|  9.8 |      413 | #                                    |  0.1975 | 95.1858 |
| 10.0 |      377 | #                                    |  0.1803 | 95.3752 |
| 10.2 |      327 | #                                    |  0.1564 | 95.5395 |
| 10.4 |      270 | #                                    |  0.1291 | 95.6751 |
| 10.6 |      343 | #                                    |  0.1640 | 95.8475 |
| 10.8 |      286 | #                                    |  0.1368 | 95.9911 |
| 11.0 |      286 | #                                    |  0.1368 | 96.1348 |
| 11.2 |      268 | #                                    |  0.1282 | 96.2694 |
| 11.4 |      214 |                                      |  0.1023 | 96.3770 |
...

# Max seconds per pages item
select *, a.ViewSeconds/b.Pages
from viewtime as a left join article_pages as b on a.ArticleId=b.Id
where (ceil(a.ViewSeconds/b.Pages)) in
(   
    select ceil(max(a.ViewSeconds/b.Pages)) 
    from viewtime as a left join article_pages as b on a.ArticleId=b.id
);
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+
| Id     | ArticleId | TimeStamp           | ViewSeconds | UserAppId                                | Id      | Pages | a.ViewSeconds/b.Pages |
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+
| 142408 |   1746781 | 2021-03-18 22:51:33 |      163895 | dc6122d9b5cb83d27df3617a031d3c84250b5d80 | 1746781 |     3 |            54631.6667 |
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+

# List seconds per pages item
select *, a.ViewSeconds/b.Pages FROM 
viewtime as a left join article_pages as b on a.ArticleId=b.Id
order by a.ViewSeconds/b.Pages desc limit 100;
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+
| Id     | ArticleId | TimeStamp           | ViewSeconds | UserAppId                                | Id      | Pages | a.ViewSeconds/b.Pages |
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+
| 142408 |   1746781 | 2021-03-18 22:51:33 |      163895 | dc6122d9b5cb83d27df3617a031d3c84250b5d80 | 1746781 |     3 |            54631.6667 |
|  64578 |   1859413 | 2021-03-09 07:50:54 |      424640 | 5805d2e4d026abeab2c6580c535e7d65eb951529 | 1859413 |    16 |            26540.0000 |
|  67256 |   1393865 | 2021-03-09 15:31:23 |       82199 | 05ef7056ec83b28ff40f7984012833860a92a2ce | 1393865 |     5 |            16439.8000 |
| 143744 |   1867473 | 2021-03-19 04:09:37 |      357069 | 6286e022b4c961025fc5078d4d894707c6075ab4 | 1867473 |    32 |            11158.4063 |
| 199039 |   1174105 | 2021-03-25 23:25:03 |      279418 | 57d6f650bf3d20961c5b2299c84b49949264ea51 | 1174105 |    30 |             9313.9333 |
|  72915 |   1705086 | 2021-03-10 09:36:54 |       95277 | 9df0e436be76ef5c0655075550e2e149d41b6170 | 1705086 |    12 |             7939.7500 |
| 186582 |   1872677 | 2021-03-24 09:06:28 |      144145 | dabb7fb9133717883891bd50962d035548c34234 | 1872677 |    20 |             7207.2500 |
| 189678 |   1872823 | 2021-03-24 16:56:27 |       84725 | b2795ed46e036df2c9927c6b98ca11a93d95b6e8 | 1872823 |    12 |             7060.4167 |
|  78414 |   1717995 | 2021-03-11 02:12:02 |       56297 | 9df0e436be76ef5c0655075550e2e149d41b6170 | 1717995 |     8 |             7037.1250 |
|  24191 |   1858779 | 2021-03-04 09:28:02 |      176072 | 25eb23bb3435a339f98850281c85a6886de7c1af | 1858779 |    26 |             6772.0000 |
|  83249 |   1717995 | 2021-03-11 15:57:04 |       49410 | 9df0e436be76ef5c0655075550e2e149d41b6170 | 1717995 |     8 |             6176.2500 |
| 155736 |   1576549 | 2021-03-20 13:47:31 |      180781 | 417713b28afe35504cd929a6375bf2e0be3c7e3a | 1576549 |    31 |             5831.6452 |
|  90881 |   1685089 | 2021-03-12 16:04:18 |       28100 | 57d6f650bf3d20961c5b2299c84b49949264ea51 | 1685089 |     5 |             5620.0000 |
|  30242 |   1837638 | 2021-03-05 03:40:45 |      124284 | 782c531853c72ad2bb404c1840f15d086d818379 | 1837638 |    23 |             5403.6522 |
|  35851 |   1401738 | 2021-03-05 20:03:43 |       67963 | ec433f69f543adf690381cc198e6cd0d27e63bfb | 1401738 |    13 |             5227.9231 |
| 171830 |   1458846 | 2021-03-22 11:34:23 |      180555 | d1c7b982b165c593af49e0f07be56b589f5163bb | 1458846 |    35 |             5158.7143 |
| 175568 |   1747436 | 2021-03-22 21:44:15 |       40595 | 33fb7f42302ccf13df0c884490adc32ef6f33559 | 1747436 |     8 |             5074.3750 |
| 159837 |   1575828 | 2021-03-21 01:16:38 |      137882 | 33fb7f42302ccf13df0c884490adc32ef6f33559 | 1575828 |    28 |             4924.3571 |
|  97615 |   1859843 | 2021-03-13 09:20:37 |       95722 | f1ffc5829b0ec7804adb30b53bbaa76038591bb8 | 1859843 |    21 |             4558.1905 |
|  99065 |   1557490 | 2021-03-13 14:15:17 |      137206 | b2795ed46e036df2c9927c6b98ca11a93d95b6e8 | 1557490 |    31 |             4426.0000 |
| 184882 |   1645847 | 2021-03-24 04:15:10 |      156655 | 08c0a3d2449c083eed365c59afe04faab3d0b106 | 1645847 |    38 |             4122.5000 |
|  74946 |   1012122 | 2021-03-10 15:28:15 |       86293 | c9ef583d740e8ae46d5c0e5e1bd20fd30f23f0cf | 1012122 |    21 |             4109.1905 |
| 116538 |    755785 | 2021-03-15 16:35:16 |       85165 | fcea421e706ad2c07612b02c91e55401ffa02e69 |  755785 |    22 |             3871.1364 |
| 208844 |   1875506 | 2021-03-27 03:12:32 |       34069 | a0a75edb23c5342271e9a0532940d4fef3fbb85d | 1875506 |     9 |             3785.4444 |
| 208843 |   1875506 | 2021-03-27 03:12:29 |       34065 | a0a75edb23c5342271e9a0532940d4fef3fbb85d | 1875506 |     9 |             3785.0000 |
| 101279 |   1754233 | 2021-03-13 19:20:44 |      143483 | a0a75edb23c5342271e9a0532940d4fef3fbb85d | 1754233 |    38 |             3775.8684 |
|  68201 |   1819115 | 2021-03-09 17:39:23 |       88209 | c41c2f58219c135ecd3a7c350844f1473bfbcbe4 | 1819115 |    24 |             3675.3750 |
| 180311 |    558907 | 2021-03-23 13:30:27 |       14415 | 6d66d7aac7a0a0c45bfcedbf8f9a162d63ee1e4d |  558907 |     4 |             3603.7500 |
|  49603 |   1823983 | 2021-03-07 10:11:25 |       91142 | 3a494410cfeb0f7be9ec39743f0a3498981728d0 | 1823983 |    26 |             3505.4615 |
| 135819 |   1839532 | 2021-03-18 03:00:39 |      139542 | 25eb23bb3435a339f98850281c85a6886de7c1af | 1839532 |    40 |             3488.5500 |
|  70296 |   1598588 | 2021-03-10 01:21:30 |       82810 | dc6122d9b5cb83d27df3617a031d3c84250b5d80 | 1598588 |    24 |             3450.4167 |
| 184704 |   1747892 | 2021-03-24 03:49:32 |       20094 | b52938b866caf0f75cbf164c43f35b91e09d1ef8 | 1747892 |     6 |             3349.0000 |
| 141396 |   1174105 | 2021-03-18 18:42:20 |       99356 | 57d6f650bf3d20961c5b2299c84b49949264ea51 | 1174105 |    30 |             3311.8667 |
| 181968 |   1308242 | 2021-03-23 17:13:52 |       81033 | b2795ed46e036df2c9927c6b98ca11a93d95b6e8 | 1308242 |    26 |             3116.6538 |
|  83086 |    296764 | 2021-03-11 15:35:48 |       85844 | c9ef583d740e8ae46d5c0e5e1bd20fd30f23f0cf |  296764 |    28 |             3065.8571 |
| 192343 |   1833492 | 2021-03-25 02:54:38 |       77939 | a6093aa4dc74a7b9cbccb2cfe2fe4f20aebbcaed | 1833492 |    26 |             2997.6538 |
| 175719 |   1871589 | 2021-03-22 22:13:15 |       26958 | 9a8c5e3994ea255e268457b4fd64d80cc81992e8 | 1871589 |     9 |             2995.3333 |
| 155845 |   1079414 | 2021-03-20 14:11:28 |       92846 | a43d3c98000d94eeb8f09600b57690c375a62e40 | 1079414 |    33 |             2813.5152 |
| 182860 |   1078418 | 2021-03-23 19:40:09 |      105472 | 6b4cf6e57b9b80d28edeed9641586bae77538a30 | 1078418 |    38 |             2775.5789 |
|  49472 |    964468 | 2021-03-07 09:47:54 |       57459 | 1740ad2b4ccf86d3749b152d51f9449d5ae62ff3 |  964468 |    23 |             2498.2174 |
| 103614 |   1866057 | 2021-03-14 02:59:34 |       86664 | cd890e842f966b9767595c28ea1f21fd4ce12b71 | 1866057 |    35 |             2476.1143 |
|  92673 |   1759811 | 2021-03-12 21:20:21 |       26477 | 1ccf554e7b002248fac5ae4dafd7406f9296e0ff | 1759811 |    11 |             2407.0000 |
|  92672 |   1759811 | 2021-03-12 21:20:20 |       26472 | 1ccf554e7b002248fac5ae4dafd7406f9296e0ff | 1759811 |    11 |             2406.5455 |
|  92671 |   1759811 | 2021-03-12 21:20:19 |       26471 | 1ccf554e7b002248fac5ae4dafd7406f9296e0ff | 1759811 |    11 |             2406.4545 |
| 187786 |   1541953 | 2021-03-24 12:14:50 |       52019 | 33fb7f42302ccf13df0c884490adc32ef6f33559 | 1541953 |    22 |             2364.5000 |
| 183221 |   1564930 | 2021-03-23 21:52:40 |       20657 | 3cd2a33cbd8ed3abe056fffaa6a54c3a5a79f1f2 | 1564930 |     9 |             2295.2222 |
|  81591 |   1155562 | 2021-03-11 11:40:16 |       66170 | 28186e1cce861e1f89b8aad0cd77640d8cb6be24 | 1155562 |    29 |             2281.7241 |
| 199445 |   1509475 | 2021-03-26 00:50:14 |      130577 | 25eb23bb3435a339f98850281c85a6886de7c1af | 1509475 |    60 |             2176.2833 |
| 187955 |   1340089 | 2021-03-24 12:55:50 |       49865 | fac408ec1f7cbd01af3f5e7f4c7da5ec3690c663 | 1340089 |    24 |             2077.7083 |
| 143844 |   1842226 | 2021-03-19 04:44:32 |       74348 | c5039bb9c175f49bd1a8543fd613cde8219a6db6 | 1842226 |    36 |             2065.2222 |
|  65415 |   1859672 | 2021-03-09 10:30:52 |       16474 | 665cf5533f9c0e009317d40d50c8a94f1b21bc1f | 1859672 |     8 |             2059.2500 |
|  96809 |   1450341 | 2021-03-13 07:34:12 |       51424 | ef9e2cd2f719c898107e80336851b9908c65abf9 | 1450341 |    25 |             2056.9600 |
| 152453 |   1869985 | 2021-03-20 04:45:01 |       32427 | cb520f73857e8bf765468272fe17484efaaf41f2 | 1869985 |    16 |             2026.6875 |
| 203141 |   1875096 | 2021-03-26 11:54:19 |       57147 | 8d7cd136efb62bf810bff8ffe421a50fb4f5e2b5 | 1875096 |    29 |             1970.5862 |
|   7174 |   1840641 | 2021-03-02 00:25:30 |       27347 | 665cf5533f9c0e009317d40d50c8a94f1b21bc1f | 1840641 |    14 |             1953.3571 |
|  46067 |    829733 | 2021-03-07 01:18:32 |       50596 | 4c0670cf74f4018dfda88c0aa78444966f31a361 |  829733 |    26 |             1946.0000 |
| 133067 |   1816286 | 2021-03-17 17:14:42 |       52574 | a43d3c98000d94eeb8f09600b57690c375a62e40 | 1816286 |    28 |             1877.6429 |
|  53344 |   1861986 | 2021-03-07 19:26:56 |       39137 | 97f107853d8d798149a92e3b3485065e516b93c7 | 1861986 |    21 |             1863.6667 |
|  53342 |   1861986 | 2021-03-07 19:26:56 |       39136 | 97f107853d8d798149a92e3b3485065e516b93c7 | 1861986 |    21 |             1863.6190 |
| 161874 |   1782515 | 2021-03-21 06:03:44 |       64617 | 5288c85b2b575bf4f1fbf3a96afed9f75662475e | 1782515 |    36 |             1794.9167 |
| 134363 |   1787275 | 2021-03-17 21:39:13 |       37690 | 33fb7f42302ccf13df0c884490adc32ef6f33559 | 1787275 |    21 |             1794.7619 |
|  93533 |   1864970 | 2021-03-13 00:18:15 |        7125 | 0c256bfa89bd2c1ae1ae41298f5f044f2e89895c | 1864970 |     4 |             1781.2500 |
|  77703 |   1464950 | 2021-03-10 23:57:14 |       59536 | 33fb7f42302ccf13df0c884490adc32ef6f33559 | 1464950 |    34 |             1751.0588 |
| 185412 |   1769783 | 2021-03-24 05:44:16 |       44612 | 44fc4c3f89018393fdff153e06ccb9dfee16ddbb | 1769783 |    26 |             1715.8462 |
| 136054 |   1581188 | 2021-03-18 03:48:30 |       29979 | bb99779906d3774591712b3a9127ffe47dc45072 | 1581188 |    18 |             1665.5000 |
| 104540 |   1076654 | 2021-03-14 05:02:31 |       33120 | 5f82d80e1ac9d576972357cbf3643e4669689f76 | 1076654 |    20 |             1656.0000 |
|  25772 |    953853 | 2021-03-04 14:17:04 |       79058 | 30a2d63398fdc2e3f58a7d8e0dda40ff6a70fe52 |  953853 |    48 |             1647.0417 |
| 107223 |   1855962 | 2021-03-14 12:30:23 |       73644 | beb76d693e47eeff35fec877fb3ebf136da33222 | 1855962 |    45 |             1636.5333 |
| 152631 |    914897 | 2021-03-20 05:08:04 |       27558 | a0ba7a612e9d3e1eb4dc4c38a2b40d09800bcada |  914897 |    17 |             1621.0588 |
| 152630 |    914897 | 2021-03-20 05:08:03 |       27556 | a0ba7a612e9d3e1eb4dc4c38a2b40d09800bcada |  914897 |    17 |             1620.9412 |
| 200264 |   1875006 | 2021-03-26 03:22:08 |       30414 | 1c16de80b6d78f6e93bb2fe62c81973baf32e03b | 1875006 |    19 |             1600.7368 |
|  42182 |   1860401 | 2021-03-06 14:36:50 |       90806 | b2795ed46e036df2c9927c6b98ca11a93d95b6e8 | 1860401 |    57 |             1593.0877 |
| 207882 |   1726224 | 2021-03-27 00:56:08 |       25256 | 1abcce424f2ac2ed688a29f29318c8d0a585340c | 1726224 |    16 |             1578.5000 |
|  91191 |   1808160 | 2021-03-12 16:37:30 |      103400 | 28186e1cce861e1f89b8aad0cd77640d8cb6be24 | 1808160 |    66 |             1566.6667 |
| 148812 |   1853250 | 2021-03-19 18:19:48 |       65008 | b2795ed46e036df2c9927c6b98ca11a93d95b6e8 | 1853250 |    42 |             1547.8095 |
| 142982 |   1837858 | 2021-03-19 01:25:30 |       52403 | 6b4cf6e57b9b80d28edeed9641586bae77538a30 | 1837858 |    34 |             1541.2647 |
| 206298 |   1788400 | 2021-03-26 19:46:29 |       20015 | 50fc9344ec34cd39c04b1d0989c13a356077eb13 | 1788400 |    13 |             1539.6154 |
|  45544 |   1046102 | 2021-03-06 23:56:49 |       50420 | 94bb89ce8bdb68c82feab2ef5224545abe05bd93 | 1046102 |    33 |             1527.8788 |
| 128229 |   1272426 | 2021-03-17 04:54:48 |       38083 | 8d7cd136efb62bf810bff8ffe421a50fb4f5e2b5 | 1272426 |    25 |             1523.3200 |
| 118743 |   1867002 | 2021-03-16 00:13:21 |       40279 | e511f7ec35fdc095a88a16cb1bb0753a3c3faaa7 | 1867002 |    27 |             1491.8148 |
|  54837 |   1497847 | 2021-03-08 01:39:17 |       65444 | a43d3c98000d94eeb8f09600b57690c375a62e40 | 1497847 |    44 |             1487.3636 |
| 144531 |   1806559 | 2021-03-19 06:42:07 |       36758 | ec433f69f543adf690381cc198e6cd0d27e63bfb | 1806559 |    25 |             1470.3200 |
|   9902 |   1859006 | 2021-03-02 10:50:56 |       34933 | 6c8256ba2ac4db255f1dc5deb29651f5790c76bd | 1859006 |    24 |             1455.5417 |
| 145869 |   1818963 | 2021-03-19 10:34:42 |       46021 | 33fb7f42302ccf13df0c884490adc32ef6f33559 | 1818963 |    32 |             1438.1563 |
| 102768 |   1688387 | 2021-03-14 00:59:27 |       11357 | dcd19363564a17a2b7f118544dc2759cbdabae23 | 1688387 |     8 |             1419.6250 |
| 148137 |   1231603 | 2021-03-19 16:47:06 |       36018 | ec433f69f543adf690381cc198e6cd0d27e63bfb | 1231603 |    26 |             1385.3077 |
|  16140 |   1537325 | 2021-03-03 07:29:57 |       82908 | 213ce052c33ea769d652d19e7504ddada396b9ff | 1537325 |    60 |             1381.8000 |
| 119467 |   1842959 | 2021-03-16 02:26:52 |       32928 | 8d7cd136efb62bf810bff8ffe421a50fb4f5e2b5 | 1842959 |    24 |             1372.0000 |
|  78719 |   1393746 | 2021-03-11 03:05:10 |       25993 | 8d6cbdf453d5493d08580781a1339e27904c1dfd | 1393746 |    19 |             1368.0526 |
|  88296 |   1843391 | 2021-03-12 08:29:53 |       23218 | dc6122d9b5cb83d27df3617a031d3c84250b5d80 | 1843391 |    17 |             1365.7647 |
|  91365 |   1866024 | 2021-03-12 17:04:11 |       10867 | 6f8f0cb92d69501161126763674d68eba00abd75 | 1866024 |     8 |             1358.3750 |
|  62373 |   1863645 | 2021-03-09 00:09:39 |       29598 | b2795ed46e036df2c9927c6b98ca11a93d95b6e8 | 1863645 |    22 |             1345.3636 |
|  21718 |   1690458 | 2021-03-04 02:11:15 |       41332 | fe7048a10c4de4a5ee3d128f0f9cc643ff53fada | 1690458 |    31 |             1333.2903 |
|  21717 |   1690458 | 2021-03-04 02:11:14 |       41330 | fe7048a10c4de4a5ee3d128f0f9cc643ff53fada | 1690458 |    31 |             1333.2258 |
|  32389 |   1661622 | 2021-03-05 10:43:44 |       30543 | cf04fefd77e42f43afe5c2f4eb4fa4bc086bf4ad | 1661622 |    23 |             1327.9565 |
| 119693 |   1858699 | 2021-03-16 03:03:05 |       35350 | 57b63be08fb293c579a3da54dbfe6d49b1d54188 | 1858699 |    27 |             1309.2593 |
|  39355 |   1466712 | 2021-03-06 06:11:47 |      250974 | 213ce052c33ea769d652d19e7504ddada396b9ff | 1466712 |   193 |             1300.3834 |
|  50476 |   1862332 | 2021-03-07 13:08:17 |        7794 | f9b134fc9eaac116b0666984c703085864455ed1 | 1862332 |     6 |             1299.0000 |
| 156071 |   1665991 | 2021-03-20 14:46:18 |        9027 | f9b134fc9eaac116b0666984c703085864455ed1 | 1665991 |     7 |             1289.5714 |
|  86967 |   1747586 | 2021-03-12 04:06:48 |       38589 | bd6256742105a71c86be53e90fb203b5e3c4b143 | 1747586 |    30 |             1286.3000 |
...
```

## Detect Abuse

```sql
# Total Users Count
select count(*) as C, UserAppId from viewtotal 
    group by UserAppId 
    order by C desc;

# Read per User
select C, count(*) as D from 
(
    select count(*) as C, UserAppId from viewtotal 
    group by UserAppId 
    order by C
) as B
group by C 
order by D asc;

# Read per Article
select ArticleId, count(*) as C
from viewtotal 
group by ArticleId 
order by C asc;

# User per Read
select UserAppId, count(*) as C from viewtotal 
where UserAppId IS NOT NULL and UserAppId<>'test'
group by UserAppId order by C desc limit 100;

# User Read Rhythm
select hour(TimeStamp), count(*), repeat('#', count(*)/10)
from viewtotal
where UserAppId='42c86650039a2a4e674ae89fb23b63d89c74bd59' 
group by hour(TimeStamp);

# User Duplicate Read Articles
select ArticleId, count(*) from viewtotal
where UserAppId='42c86650039a2a4e674ae89fb23b63d89c74bd59' 
group by ArticleId;

# Check using viewtotal
select ArticleId, count(*) as C, UserAppId, min(TimeStamp), max(TimeStamp) from viewtotal
where UserAppId IS NOT NULL and UserAppId<>'test'
group by UserAppId, ArticleId
order by C desc
limit 100;

select a.ArticleId, count(*) as C, a.UserAppId, min(a.TimeStamp), max(a.TimeStamp), sum(b.ViewSeconds), avg(b.ViewSeconds)
from viewtotal as a left join viewtime as b on a.ArticleId=b.ArticleId and a.UserAppId=b.UserAppId 
where a.UserAppId IS NOT NULL and a.UserAppId<>'test'
group by a.UserAppId, a.ArticleId
order by C desc
limit 100;

select a.Id, a.ArticleId, a.TimeStamp, a.UserAppId, b.TimeStamp, b.ViewSeconds
from viewtotal as a left join viewtime as b on a.ArticleId=b.ArticleId and a.UserAppId=b.UserAppId
where a.UserAppId IS NOT NULL and a.UserAppId<>'test' and b.ViewSeconds IS NOT NULL
order by a.Id desc
limit 100;

# Check using viewtime
select ArticleId, count(*) as C, UserAppId, min(TimeStamp), max(TimeStamp), avg(ViewSeconds), min(ViewSeconds), max(ViewSeconds)
from viewtime
where UserAppId IS NOT NULL and UserAppId<>'test'
group by UserAppId, ArticleId
order by C desc
limit 100;

```

## Real Time Ranking (use SQL)

```sql
# Last Day
select ArticleId, count(*) as C
from viewtime
where ViewSeconds>=24 and TimeStamp between date_sub(now(),INTERVAL 1 DAY) and now()
group by ArticleId
order by C desc
limit 100;

# Last Week
select ArticleId, count(*) as C
from viewtime
where ViewSeconds>=24 and TimeStamp between date_sub(now(),INTERVAL 1 WEEK) and now()
group by ArticleId
order by C desc
limit 100;

# Last Month
select ArticleId, count(*) as C
from viewtime
where ViewSeconds>=24 and TimeStamp between date_sub(now(),INTERVAL 1 MONTH) and now()
group by ArticleId
order by C desc
limit 100;

# All Time
select ArticleId, count(*) as C
from viewtime
where ViewSeconds>=24
group by ArticleId
order by C desc
limit 100;
```