# Violet Statistics

## Query for View Time

```sql
# Basic
select count(*) from viewtime;
+----------+
| count(*) |
+----------+
|   209119 |
+----------+ 
select count(*) 
from viewtime as a left join article_pages as b on a.ArticleId=b.Id where b.Pages<>0;
+----------+
| count(*) |
+----------+
|   199059 |
+----------+
select count(*) from (select * from viewtime
group by ViewSeconds order by ViewSeconds) as a;
+----------+
| count(*) |
+----------+
|     3084 |
+----------+

# Average, Variance whatching seconds per pages
select avg(a.ViewSeconds/b.Pages), variance(a.ViewSeconds/b.Pages) from viewtime 
as a left join article_pages as b on a.ArticleId=b.Id where b.Pages<>0;
+----------------------------+---------------------------------+
| avg(a.ViewSeconds/b.Pages) | variance(a.ViewSeconds/b.Pages) |
+----------------------------+---------------------------------+
|                 6.21027920 |                  26519.15946969 |
+----------------------------+---------------------------------+
std: 162.847043171
  p: x<=302.50143 = 0.9808

# ViewSeconds Counts
select ViewSeconds, count(*), repeat('#', count(*)/100), count(*)/209119*100 as percent, 
SUM(count(*)/209119*100) OVER(ORDER BY ViewSeconds) as acc
from viewtime
group by ViewSeconds order by ViewSeconds limit 1000;
+-------------+----------+------------------------------------------+---------+---------+
| ViewSeconds | count(*) | repeat('#', count(*)/100)                | percent | acc     |
+-------------+----------+------------------------------------------+---------+---------+
|           0 |       11 |                                          |  0.0053 |  0.0053 |
|           1 |      322 | ###                                      |  0.1540 |  0.1592 |
|           2 |     1170 | ############                             |  0.5595 |  0.7187 |
|           3 |     1471 | ###############                          |  0.7034 |  1.4222 |
|           4 |     1710 | #################                        |  0.8177 |  2.2399 |
|           5 |     2403 | ########################                 |  1.1491 |  3.3890 |
|           6 |     3238 | ################################         |  1.5484 |  4.9374 |
|           7 |     3732 | #####################################    |  1.7846 |  6.7220 |
|           8 |     3984 | ######################################## |  1.9051 |  8.6271 |
|           9 |     3921 | #######################################  |  1.8750 | 10.5022 |
|          10 |     3798 | ######################################   |  1.8162 | 12.3183 |
|          11 |     3783 | ######################################   |  1.8090 | 14.1274 |
|          12 |     3525 | ###################################      |  1.6856 | 15.8130 |
|          13 |     3382 | ##################################       |  1.6173 | 17.4303 |
|          14 |     3221 | ################################         |  1.5403 | 18.9705 |
|          15 |     2954 | ##############################           |  1.4126 | 20.3831 |
|          16 |     2825 | ############################             |  1.3509 | 21.7340 |
|          17 |     2669 | ###########################              |  1.2763 | 23.0103 |
|          18 |     2526 | #########################                |  1.2079 | 24.2183 |
|          19 |     2421 | ########################                 |  1.1577 | 25.3760 |
|          20 |     2308 | #######################                  |  1.1037 | 26.4797 |
|          21 |     2157 | ######################                   |  1.0315 | 27.5111 |
|          22 |     2170 | ######################                   |  1.0377 | 28.5488 |
|          23 |     2069 | #####################                    |  0.9894 | 29.5382 |
|          24 |     1946 | ###################                      |  0.9306 | 30.4688 |
|          25 |     1937 | ###################                      |  0.9263 | 31.3950 |
|          26 |     1786 | ##################                       |  0.8541 | 32.2491 |
|          27 |     1717 | #################                        |  0.8211 | 33.0702 |
|          28 |     1786 | ##################                       |  0.8541 | 33.9242 |
|          29 |     1656 | #################                        |  0.7919 | 34.7161 |
|          30 |     1625 | ################                         |  0.7771 | 35.4932 |
|          31 |     1479 | ###############                          |  0.7073 | 36.2004 |
|          32 |     1546 | ###############                          |  0.7393 | 36.9397 |
|          33 |     1457 | ###############                          |  0.6967 | 37.6365 |
|          34 |     1450 | ###############                          |  0.6934 | 38.3298 |
|          35 |     1398 | ##############                           |  0.6685 | 38.9984 |
|          36 |     1347 | #############                            |  0.6441 | 39.6425 |
|          37 |     1397 | ##############                           |  0.6680 | 40.3105 |
|          38 |     1372 | ##############                           |  0.6561 | 40.9666 |
|          39 |     1314 | #############                            |  0.6284 | 41.5950 |
|          40 |     1272 | #############                            |  0.6083 | 42.2032 |
|          41 |     1225 | ############                             |  0.5858 | 42.7890 |
|          42 |     1235 | ############                             |  0.5906 | 43.3796 |
|          43 |     1293 | #############                            |  0.6183 | 43.9979 |
|          44 |     1183 | ############                             |  0.5657 | 44.5636 |
|          45 |     1225 | ############                             |  0.5858 | 45.1494 |
|          46 |     1201 | ############                             |  0.5743 | 45.7237 |
|          47 |     1122 | ###########                              |  0.5365 | 46.2603 |
|          48 |     1167 | ############                             |  0.5581 | 46.8183 |
|          49 |     1141 | ###########                              |  0.5456 | 47.3639 |
|          50 |     1051 | ###########                              |  0.5026 | 47.8665 |
|          51 |     1134 | ###########                              |  0.5423 | 48.4088 |
|          52 |     1067 | ###########                              |  0.5102 | 48.9190 |
|          53 |     1032 | ##########                               |  0.4935 | 49.4125 |
|          54 |     1149 | ###########                              |  0.5494 | 49.9620 |
|          55 |     1053 | ###########                              |  0.5035 | 50.4655 |
|          56 |     1034 | ##########                               |  0.4945 | 50.9600 |
|          57 |     1026 | ##########                               |  0.4906 | 51.4506 |
|          58 |     1059 | ###########                              |  0.5064 | 51.9570 |
|          59 |      972 | ##########                               |  0.4648 | 52.4218 |
|          60 |      915 | #########                                |  0.4375 | 52.8594 |
|          61 |      980 | ##########                               |  0.4686 | 53.3280 |
|          62 |      962 | ##########                               |  0.4600 | 53.7880 |
|          63 |      936 | #########                                |  0.4476 | 54.2356 |
|          64 |      965 | ##########                               |  0.4615 | 54.6971 |
|          65 |      912 | #########                                |  0.4361 | 55.1332 |
|          66 |      940 | #########                                |  0.4495 | 55.5827 |
|          67 |      907 | #########                                |  0.4337 | 56.0164 |
|          68 |      867 | #########                                |  0.4146 | 56.4310 |
|          69 |      928 | #########                                |  0.4438 | 56.8748 |
|          70 |      876 | #########                                |  0.4189 | 57.2937 |
|          71 |      925 | #########                                |  0.4423 | 57.7360 |
|          72 |      868 | #########                                |  0.4151 | 58.1511 |
|          73 |      838 | ########                                 |  0.4007 | 58.5518 |
|          74 |      866 | #########                                |  0.4141 | 58.9659 |
|          75 |      822 | ########                                 |  0.3931 | 59.3590 |
|          76 |      833 | ########                                 |  0.3983 | 59.7574 |
|          77 |      822 | ########                                 |  0.3931 | 60.1504 |
|          78 |      871 | #########                                |  0.4165 | 60.5669 |
|          79 |      835 | ########                                 |  0.3993 | 60.9662 |
|          80 |      789 | ########                                 |  0.3773 | 61.3435 |
|          81 |      759 | ########                                 |  0.3630 | 61.7065 |
|          82 |      800 | ########                                 |  0.3826 | 62.0890 |
|          83 |      749 | #######                                  |  0.3582 | 62.4472 |
|          84 |      781 | ########                                 |  0.3735 | 62.8207 |
|          85 |      736 | #######                                  |  0.3520 | 63.1726 |
|          86 |      759 | ########                                 |  0.3630 | 63.5356 |
|          87 |      707 | #######                                  |  0.3381 | 63.8737 |
|          88 |      723 | #######                                  |  0.3457 | 64.2194 |
|          89 |      780 | ########                                 |  0.3730 | 64.5924 |
|          90 |      727 | #######                                  |  0.3476 | 64.9401 |
|          91 |      708 | #######                                  |  0.3386 | 65.2786 |
|          92 |      687 | #######                                  |  0.3285 | 65.6071 |
|          93 |      702 | #######                                  |  0.3357 | 65.9428 |
|          94 |      669 | #######                                  |  0.3199 | 66.2627 |
|          95 |      667 | #######                                  |  0.3190 | 66.5817 |
|          96 |      650 | #######                                  |  0.3108 | 66.8925 |
|          97 |      641 | ######                                   |  0.3065 | 67.1991 |
|          98 |      694 | #######                                  |  0.3319 | 67.5309 |
|          99 |      666 | #######                                  |  0.3185 | 67.8494 |
|         100 |      632 | ######                                   |  0.3022 | 68.1516 |
|         101 |      618 | ######                                   |  0.2955 | 68.4471 |
|         102 |      665 | #######                                  |  0.3180 | 68.7651 |
|         103 |      611 | ######                                   |  0.2922 | 69.0573 |
...

# Seconds per Pages Counts
select truncate(round(a.ViewSeconds/b.Pages*5.0)/5.0,1) as c, count(*), repeat('#', count(*)/500), 
count(*)/209119*100 as percent, SUM(count(*)/209119*100) OVER(ORDER BY c) as acc 
from viewtime as a left join article_pages as b on a.ArticleId=b.Id 
where b.Pages <> 0
group by c order by c limit 100;
+------+----------+--------------------------------------+---------+---------+
| c    | count(*) | repeat('#', count(*)/500)            | percent | acc     |
+------+----------+--------------------------------------+---------+---------+
|  0.0 |    16725 | #################################    |  7.9978 |  7.9978 |
|  0.2 |    18071 | #################################### |  8.6415 | 16.6393 |
|  0.4 |    13103 | ##########################           |  6.2658 | 22.9051 |
|  0.6 |    11274 | #######################              |  5.3912 | 28.2963 |
|  0.8 |     8968 | ##################                   |  4.2885 | 32.5848 |
|  1.0 |     7939 | ################                     |  3.7964 | 36.3812 |
|  1.2 |     7209 | ##############                       |  3.4473 | 39.8285 |
|  1.4 |     6392 | #############                        |  3.0566 | 42.8852 |
|  1.6 |     6686 | #############                        |  3.1972 | 46.0824 |
|  1.8 |     5979 | ############                         |  2.8591 | 48.9415 |
|  2.0 |     5525 | ###########                          |  2.6420 | 51.5835 |
|  2.2 |     5375 | ###########                          |  2.5703 | 54.1539 |
|  2.4 |     4768 | ##########                           |  2.2800 | 56.4339 |
|  2.6 |     5041 | ##########                           |  2.4106 | 58.8445 |
|  2.8 |     4609 | #########                            |  2.2040 | 61.0485 |
|  3.0 |     4471 | #########                            |  2.1380 | 63.1865 |
|  3.2 |     4193 | ########                             |  2.0051 | 65.1916 |
|  3.4 |     3580 | #######                              |  1.7119 | 66.9035 |
|  3.6 |     3846 | ########                             |  1.8391 | 68.7427 |
|  3.8 |     3557 | #######                              |  1.7009 | 70.4436 |
|  4.0 |     3278 | #######                              |  1.5675 | 72.0112 |
|  4.2 |     3157 | ######                               |  1.5097 | 73.5208 |
|  4.4 |     2649 | #####                                |  1.2667 | 74.7876 |
|  4.6 |     2889 | ######                               |  1.3815 | 76.1691 |
|  4.8 |     2492 | #####                                |  1.1917 | 77.3607 |
|  5.0 |     2367 | #####                                |  1.1319 | 78.4926 |
|  5.2 |     2238 | ####                                 |  1.0702 | 79.5628 |
|  5.4 |     1905 | ####                                 |  0.9110 | 80.4738 |
|  5.6 |     2068 | ####                                 |  0.9889 | 81.4627 |
|  5.8 |     1751 | ####                                 |  0.8373 | 82.3000 |
|  6.0 |     1629 | ###                                  |  0.7790 | 83.0790 |
|  6.2 |     1507 | ###                                  |  0.7206 | 83.7997 |
|  6.4 |     1284 | ###                                  |  0.6140 | 84.4137 |
|  6.6 |     1335 | ###                                  |  0.6384 | 85.0521 |
|  6.8 |     1109 | ##                                   |  0.5303 | 85.5824 |
|  7.0 |     1133 | ##                                   |  0.5418 | 86.1242 |
|  7.2 |     1005 | ##                                   |  0.4806 | 86.6048 |
|  7.4 |      884 | ##                                   |  0.4227 | 87.0275 |
|  7.6 |      971 | ##                                   |  0.4643 | 87.4918 |
|  7.8 |      831 | ##                                   |  0.3974 | 87.8892 |
|  8.0 |      777 | ##                                   |  0.3716 | 88.2607 |
|  8.2 |      704 | #                                    |  0.3367 | 88.5974 |
|  8.4 |      603 | #                                    |  0.2884 | 88.8858 |
|  8.6 |      663 | #                                    |  0.3170 | 89.2028 |
|  8.8 |      607 | #                                    |  0.2903 | 89.4931 |
|  9.0 |      511 | #                                    |  0.2444 | 89.7374 |
|  9.2 |      527 | #                                    |  0.2520 | 89.9894 |
|  9.4 |      414 | #                                    |  0.1980 | 90.1874 |
|  9.6 |      426 | #                                    |  0.2037 | 90.3911 |
|  9.8 |      413 | #                                    |  0.1975 | 90.5886 |
| 10.0 |      377 | #                                    |  0.1803 | 90.7689 |
| 10.2 |      327 | #                                    |  0.1564 | 90.9253 |
| 10.4 |      270 | #                                    |  0.1291 | 91.0544 |
| 10.6 |      343 | #                                    |  0.1640 | 91.2184 |
| 10.8 |      286 | #                                    |  0.1368 | 91.3552 |
| 11.0 |      286 | #                                    |  0.1368 | 91.4919 |
| 11.2 |      268 | #                                    |  0.1282 | 91.6201 |
| 11.4 |      214 |                                      |  0.1023 | 91.7224 |
...

# Max seconds per pages item
select *, a.ViewSeconds/b.Pages FROM 
viewtime as a left join article_pages as b on a.ArticleId=b.Id
WHERE (ceil(a.ViewSeconds/b.Pages)) IN
(select ceil(max(a.ViewSeconds/b.Pages)) from viewtime as a left join article_pages as b on a.ArticleId=b.id);
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+
| Id     | ArticleId | TimeStamp           | ViewSeconds | UserAppId                                | Id      | Pages | a.ViewSeconds/b.Pages |
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+
| 142408 |   1746781 | 2021-03-18 22:51:33 |      163895 | dc6122d9b5cb83d27df3617a031d3c84250b5d80 | 1746781 |     3 |            54631.6667 |
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+

# List seconds per pages item
select *, a.ViewSeconds/b.Pages FROM 
viewtime as a left join article_pages as b on a.ArticleId=b.Id
order by a.ViewSeconds/b.Pages desc limit 100;
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+
| Id     | ArticleId | TimeStamp           | ViewSeconds | UserAppId                                | Id      | Pages | a.ViewSeconds/b.Pages |
+--------+-----------+---------------------+-------------+------------------------------------------+---------+-------+-----------------------+
| 142408 |   1746781 | 2021-03-18 22:51:33 |      163895 | dc6122d9b5cb83d27df3617a031d3c84250b5d80 | 1746781 |     3 |            54631.6667 |
|  64578 |   1859413 | 2021-03-09 07:50:54 |      424640 | 5805d2e4d026abeab2c6580c535e7d65eb951529 | 1859413 |    16 |            26540.0000 |
|  67256 |   1393865 | 2021-03-09 15:31:23 |       82199 | 05ef7056ec83b28ff40f7984012833860a92a2ce | 1393865 |     5 |            16439.8000 |
| 143744 |   1867473 | 2021-03-19 04:09:37 |      357069 | 6286e022b4c961025fc5078d4d894707c6075ab4 | 1867473 |    32 |            11158.4063 |
| 199039 |   1174105 | 2021-03-25 23:25:03 |      279418 | 57d6f650bf3d20961c5b2299c84b49949264ea51 | 1174105 |    30 |             9313.9333 |
|  72915 |   1705086 | 2021-03-10 09:36:54 |       95277 | 9df0e436be76ef5c0655075550e2e149d41b6170 | 1705086 |    12 |             7939.7500 |
| 186582 |   1872677 | 2021-03-24 09:06:28 |      144145 | dabb7fb9133717883891bd50962d035548c34234 | 1872677 |    20 |             7207.2500 |
...
```